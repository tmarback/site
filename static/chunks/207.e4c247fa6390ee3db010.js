(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[207],{"4nv/":function(e,t,a){"use strict";function n(e,t,a,n){a&&Object.defineProperty(e,t,{enumerable:a.enumerable,configurable:a.configurable,writable:a.writable,value:a.initializer?a.initializer.call(n):void 0})}a.d(t,"a",(function(){return n}))},ACih:function(e,t,a){"use strict"},EaFg:function(e,t,a){"use strict";function n(e,t,a,n,r){var o={};return Object.keys(n).forEach((function(e){o[e]=n[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=a.slice().reverse().reduce((function(a,n){return n(e,t,a)||a}),o),r&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(r):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}a.d(t,"a",(function(){return n}))},QcNg:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a("E/M9");const r=e=>{var t,a,r;const o={};o.content=null!==(t=e.content)&&void 0!==t?t:"",o.username=null!==(a=e.username)&&void 0!==a?a:"",o.avatar=null!==(r=e.avatar_url)&&void 0!==r?r:"";const s=[];o.embeds=s;for(const P of null!==(i=e.embeds)&&void 0!==i?i:[]){var i,c,l,u,d,b,p,j,h,g,m,f,v,O,w,k,y,x,C,M,B;let e=s.length>0?s[s.length-1]:void 0;if(null!==(c=e)&&void 0!==c&&c.url&&e.url===P.url){var D;const t=e.gallery;null!==(D=P.image)&&void 0!==D&&D.url&&t.length<4&&t.push(P.image.url);continue}e={},s.push(e),e.title=null!==(l=P.title)&&void 0!==l?l:"",e.description=null!==(u=P.description)&&void 0!==u?u:"",e.url=null!==(d=P.url)&&void 0!==d?d:"",e.author=null!==(b=null===(p=P.author)||void 0===p?void 0:p.name)&&void 0!==b?b:"",e.authorUrl=null!==(j=null===(h=P.author)||void 0===h?void 0:h.url)&&void 0!==j?j:"",e.authorIcon=null!==(g=null===(m=P.author)||void 0===m?void 0:m.icon_url)&&void 0!==g?g:"",e.footer=null!==(f=null===(v=P.footer)||void 0===v?void 0:v.text)&&void 0!==f?f:"",e.footerIcon=null!==(O=null===(w=P.footer)||void 0===w?void 0:w.icon_url)&&void 0!==O?O:"",e.timestamp=new Date(null!==(k=P.timestamp)&&void 0!==k?k:Number.NaN),e.gallery=[null!==(y=null===(x=P.image)||void 0===x?void 0:x.url)&&void 0!==y?y:""].filter(Boolean),e.thumbnail=null!==(C=null===(M=P.thumbnail)||void 0===M?void 0:M.url)&&void 0!==C?C:"";const t=n.a.create();t.setRaw(null!==(B=P.color)&&void 0!==B?B:null),e.color=t;const a=[];e.fields=a;for(const n of null!==(S=P.fields)&&void 0!==S?S:[]){var S,L,I,E;const e={};a.push(e),e.name=null!==(L=n.name)&&void 0!==L?L:"",e.value=null!==(I=n.value)&&void 0!==I?I:"",e.inline=null!==(E=n.inline)&&void 0!==E&&E}}return o}},uid3:function(e,t,a){"use strict";a.r(t),a.d(t,"BackupsModal",(function(){return Ie}));var n=a("nKUr"),r=a("aoTL"),o=a("q1tI"),s=a("GyG+"),i=a("JrLk"),c=a("KpTw"),l=a("LZrb"),u=a("YmNt"),d=a("g+2O"),b=a("nGg0"),p=a("mNbY"),j=a("xnAi"),h=a("uEgJ"),g=a("ytgV"),m=a("eoCo"),f=a("4nv/"),v=a("EaFg"),O=(a("ACih"),a("2vnA"));let w,k;const y=new WeakMap,x=new WeakMap,C=new WeakMap,M=new WeakMap,B=new WeakMap;let D={get(e,t,a){if(e instanceof IDBTransaction){if("done"===t)return x.get(e);if("objectStoreNames"===t)return e.objectStoreNames||C.get(e);if("store"===t)return a.objectStoreNames[1]?void 0:a.objectStore(a.objectStoreNames[0])}return I(e[t])},set:(e,t,a)=>(e[t]=a,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function S(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(k||(k=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(E(this),t),I(y.get(this))}:function(...t){return I(e.apply(E(this),t))}:function(t,...a){const n=e.call(E(this),t,...a);return C.set(n,t.sort?t.sort():[t]),I(n)}}function L(e){return"function"===typeof e?S(e):(e instanceof IDBTransaction&&function(e){if(x.has(e))return;const t=new Promise(((t,a)=>{const n=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",o),e.removeEventListener("abort",o)},r=()=>{t(),n()},o=()=>{a(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",r),e.addEventListener("error",o),e.addEventListener("abort",o)}));x.set(e,t)}(e),t=e,(w||(w=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,D):e);var t}function I(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,a)=>{const n=()=>{e.removeEventListener("success",r),e.removeEventListener("error",o)},r=()=>{t(I(e.result)),n()},o=()=>{a(e.error),n()};e.addEventListener("success",r),e.addEventListener("error",o)}));return t.then((t=>{t instanceof IDBCursor&&y.set(t,e)})).catch((()=>{})),B.set(t,e),t}(e);if(M.has(e))return M.get(e);const t=L(e);return t!==e&&(M.set(e,t),B.set(t,e)),t}const E=e=>B.get(e);const P=["get","getKey","getAll","getAllKeys","count"],N=["put","add","delete","clear"],A=new Map;function V(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(A.get(t))return A.get(t);const a=t.replace(/FromIndex$/,""),n=t!==a,r=N.includes(a);if(!(a in(n?IDBIndex:IDBObjectStore).prototype)||!r&&!P.includes(a))return;const o=async function(e,...t){const o=this.transaction(e,r?"readwrite":"readonly");let s=o.store;return n&&(s=s.index(t.shift())),(await Promise.all([s[a](...t),r&&o.done]))[0]};return A.set(t,o),o}D=(e=>({...e,get:(t,a,n)=>V(t,a)||e.get(t,a,n),has:(t,a)=>!!V(t,a)||e.has(t,a)}))(D);const z=()=>{const e=document.createElement("div");e.id="db-upgrade-blocked",e.style.position="absolute",e.style.top="0",e.style.right="0",e.style.bottom="0",e.style.left="0",e.style.background="rgba(0, 0, 0, 0.85)",e.style.padding="16px";const t=document.createElement("h1");t.style.color="#ffffff",t.append("Discohook's local database needs an upgrade");const a=document.createElement("p");a.append("However, the upgrade can't proceed because there are older sessions of Discohook open.");const n=document.createElement("p");n.append("Please close all Discohook tabs before continuing."),e.append(t,a,n),document.body.append(e)};var W=a("dhJC"),q=a("cpVT");const H=e=>"object"===typeof e&&null!==e,K=(e,t)=>{if(Array.isArray(e))return e.map((e=>H(e)?K(e,t):e));const a={};for(const[n,r]of Object.entries(e))H(r)?a[t(n)]=K(r,t):a[t(n)]=r;return a},U=e=>K(e,(e=>e.replace(/[A-Z]/g,(e=>`_${e.toLowerCase()}`))));function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function T(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(Object(a),!0).forEach((function(t){Object(q.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const J=async()=>function(e,t,{blocked:a,upgrade:n,blocking:r,terminated:o}={}){const s=indexedDB.open(e,t),i=I(s);return n&&s.addEventListener("upgradeneeded",(e=>{n(I(s.result),e.oldVersion,e.newVersion,I(s.transaction))})),a&&s.addEventListener("blocked",(()=>a())),i.then((e=>{o&&e.addEventListener("close",(()=>o())),r&&e.addEventListener("versionchange",(()=>r()))})).catch((()=>{})),i}("discohook",10,{upgrade:(e,t,a,n)=>{(async(e,t,a)=>{if(a<2&&a>=1){let e=await t.objectStore("backups").openCursor();for(;e;)await e.update({name:e.key,message:e.value}),e=await e.continue()}a<3&&(e.createObjectStore("backup",{keyPath:"id",autoIncrement:!0}),t.objectStore("backup").createIndex("name","name",{unique:!0}));if(a<4&&a>=1){const e=t.objectStore("backup"),a=new Set;let n=await e.index("name").openKeyCursor();for(;n;)a.add(n.key),n=await n.continue();let r=await t.objectStore("backups").openCursor();for(;r;)a.has(r.key)||await e.put(T(T({},r.value),{},{name:r.key,message:U(r.value.message)})),r=await r.continue()}if(a<5&&a>=1){const e=t.objectStore("backup");let a=await e.openCursor();for(;a;){const t=a.value,{message:n}=t,r=Object(W.a)(t,["message"]);await e.put(T(T({},r),{},{messages:[n]})),a=await a.continue()}}if(a<6&&a>=1){const e=t.objectStore("backup");let a=await e.openCursor();for(;a;){const t=a.value,{webhookUrl:n}=t,r=Object(W.a)(t,["webhookUrl"]);await e.put(T(T({},r),{},{target:{url:n}})),a=await a.continue()}}if(a<9&&a>=1){const e=t.objectStore("backup");let a=await e.openCursor();for(;a;){const{id:t,name:n,messages:r,target:o}=a.value;n?await e.put({id:t,name:n,messages:r.map((e=>({data:"data"in e?e.data:e,reference:"reference"in e?e.reference:o.message}))),target:{url:o.url}}):await e.delete(t),a=await a.continue()}}if(a<10&&a>=1){const e=t.objectStore("backup");let a=await e.openCursor();for(;a;){var n;const t=a.value,{target:r}=t,o=Object(W.a)(t,["target"]);await e.put(T(T({},o),{},{targets:[{url:null!==(n=r.url)&&void 0!==n?n:""}]})),a=await a.continue()}}})(e,n,t).then((()=>{var e;localStorage.setItem("database-upgraded-version","10"),null===(e=document.querySelector("#db-upgrade-blocked"))||void 0===e||e.remove()})).catch((e=>{console.error("Error on database upgrade:",e)}))},blocked:z});var _,F,$;let Z=(_=class{constructor(){let e;this.initialized=void 0,this.database=void 0,Object(f.a)(this,"persisted",F,this),Object(f.a)(this,"persistenceMessageDismissed",$,this),this.initialized=new Promise((t=>{e=t})),"storage"in navigator&&navigator.storage.persisted().then((e=>{this.persisted=e})).catch((()=>{})),J().then((t=>{this.database=t,e()})).catch((e=>{console.error("Failed to open database:",e)}))}async requestPersistence(){"chrome"in window&&await Notification.requestPermission(),"storage"in navigator&&(this.persisted=await navigator.storage.persist())}get shouldShowPersistenceWarning(){return!this.persisted&&!this.persistenceMessageDismissed}},F=Object(v.a)(_.prototype,"persisted",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),$=Object(v.a)(_.prototype,"persistenceMessageDismissed",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Object(v.a)(_.prototype,"shouldShowPersistenceWarning",[O.computed],Object.getOwnPropertyDescriptor(_.prototype,"shouldShowPersistenceWarning"),_.prototype),_);const Y=Object(o.createContext)(null);Y.displayName="DatabaseManagerContext";const G=Y.Provider;var Q=a("vOnD"),X=a("aNhp"),ee=a("+VeW"),te=a("Kn7Z");function ae(e){const{databaseManager:t}=e,a=Object(g.a)(j.a);return Object(n.jsxs)(u.a,{children:[Object(n.jsxs)(b.a,{children:[Object(n.jsx)(p.a,{children:"Notice"}),Object(n.jsx)(c.a,{icon:m.a,label:"Close",onClick:()=>a.dismiss()})]}),Object(n.jsx)(l.a,{children:Object(n.jsx)(te.a,{content:"Chrome based browsers do not allow manual control of persistent storage. As a workaround, you can grant this site permission to send notifications to allow the site to use persistent storage."})}),Object(n.jsxs)(d.a,{children:[Object(n.jsx)(i.a,{onClick:()=>a.dismiss(),children:"Cancel"}),Object(n.jsx)(s.a,{onClick:async()=>{a.dismiss(),await t.requestPersistence()},children:"Request permission"})]})]})}const ne=Q.d.div.withConfig({componentId:"sc-3x6mdx-0"})(["margin-top:16px;padding:16px;background:",";border-radius:3px;"],(({theme:e})=>e.background.secondary)),re=Q.d.h5.withConfig({componentId:"sc-3x6mdx-1"})(["margin:0 0 8px;color:",";font-size:1em;font-weight:500;line-height:1.375;"],(({theme:e})=>e.header.primary)),oe=Object(Q.d)(X.a).withConfig({componentId:"sc-3x6mdx-2"})(["margin-top:16px;"]);function se(){const e=Object(g.a)(ee.a),t=Object(g.a)(Y);return Object(r.b)((()=>Object(n.jsxs)(ne,{children:[Object(n.jsx)(re,{children:"Warning"}),Object(n.jsx)(te.a,{content:"Your browser did not grant permission to use persistent storage for this site. Data stored might be deleted by the browser when this permission is not granted."}),Object(n.jsxs)(oe,{children:[Object(n.jsx)(s.a,{onClick:async()=>{"chrome"in window?e.spawn({render:()=>Object(n.jsx)(ae,{databaseManager:t})}):await t.requestPersistence()},children:"Request permission"}),Object(n.jsx)(i.a,{onClick:()=>{t.persistenceMessageDismissed=!0},children:"Dismiss"})]})]})))}const ie=(e,t)=>{const a=URL.createObjectURL(e),n=document.createElement("a");document.body.append(n),n.href=a,n.download=t,n.click(),n.remove(),URL.revokeObjectURL(a)};var ce,le,ue=a("QcNg");function de(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function be(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?de(Object(a),!0).forEach((function(t){Object(q.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):de(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}let pe=(ce=class{constructor(e,t){this.databaseManager=void 0,this.editorManager=void 0,Object(f.a)(this,"backups",le,this),this.databaseManager=e,this.editorManager=t,e.initialized.then((async()=>{await this.loadBackupList()})).catch((()=>{}))}async loadBackupList(){const e=[];let t=await this.databaseManager.database.transaction("backup").objectStore("backup").index("name").openKeyCursor();for(;t;)e.push({id:t.primaryKey,name:t.key}),t=await t.continue();Object(O.runInAction)((()=>{this.backups=e}))}async getId(e){return this.databaseManager.database.transaction("backup").objectStore("backup").index("name").getKey(e)}async loadBackup(e){const t=await this.databaseManager.database.transaction("backup").objectStore("backup").index("name").get(e);if(t){this.editorManager.set("messages",t.messages.map((e=>{let{data:t}=e,a=Object(W.a)(e,["data"]);return be(be({},Object(ue.a)(t)),a)}))),this.editorManager.set("targets",t.targets);for(const e of this.editorManager.targets)e.fetch().catch((()=>{}))}}async saveBackup(e){if("string"===typeof e){e={id:await this.getId(e),name:e,messages:this.editorManager.messages.map((e=>({data:be(be({},e.data),{},{files:void 0}),reference:e.reference}))),targets:this.editorManager.targets.map((e=>({url:e.url})))}}else e=be(be({},e),{},{id:await this.getId(e.name)});e.id||delete e.id,await this.databaseManager.database.transaction("backup","readwrite").objectStore("backup").put(e),await this.loadBackupList()}async deleteBackup(e){const t=await this.getId(e);t&&(await this.databaseManager.database.transaction("backup","readwrite").objectStore("backup").delete(t),await this.loadBackupList())}async exportBackup(e){const t=await this.databaseManager.database.transaction("backup").objectStore("backup").index("name").get(e);if(!t)return;const a={version:7,backups:[t].map((e=>{let{id:t}=e;return Object(W.a)(e,["id"])}))},n=new Blob([JSON.stringify(a,void 0,2),"\n"],{type:"application/json"});ie(n,`${e}.json`)}async exportAll(){const e=[];let t=await this.databaseManager.database.transaction("backup").objectStore("backup").openCursor();for(;t;)e.push(be(be({},t.value),{},{id:void 0})),t=await t.continue();const a={version:7,backups:e},n=new Blob([JSON.stringify(a,void 0,2),"\n"],{type:"application/json"});ie(n,"backups.json")}async getSafeBackupName(e){if(!(await this.getId(e)))return e;for(let t=1;;t++){const a=`${e} (${t})`;if(!(await this.getId(a)))return a}}async importBackups(e){let t=JSON.parse(await e.text());switch(t.version){case 1:case 2:t={version:3,backups:[{name:t.name,message:U(t.message)}]};case 3:t={version:4,backups:t.backups.map((e=>{let{message:t}=e;return be(be({},Object(W.a)(e,["message"])),{},{messages:[t]})}))};case 4:t={version:5,backups:t.backups.map((e=>{let{webhookUrl:t}=e;return be(be({},Object(W.a)(e,["webhookUrl"])),{},{target:{url:t}})}))};case 5:t={version:6,backups:t.backups.map((e=>{let{messages:t,target:a}=e;return be(be({},Object(W.a)(e,["messages","target"])),{},{messages:t.map((e=>({data:e,reference:a.message}))),target:{url:a.url}})}))};case 6:t={version:7,backups:t.backups.map((e=>{var t;let{target:a}=e;return be(be({},Object(W.a)(e,["target"])),{},{targets:[{url:null!==(t=a.url)&&void 0!==t?t:""}]})}))};case 7:for(const e of t.backups)await this.saveBackup(be(be({},e),{},{name:await this.getSafeBackupName(e.name),id:void 0}))}}},le=Object(v.a)(ce.prototype,"backups",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ce);const je=Object(o.createContext)(null);je.displayName="BackupManagerContext";const he=je.Provider;var ge=a("8bSZ");function me(){const e=Object(g.a)(je),{0:t,1:a}=Object(o.useState)("");return Object(r.b)((()=>Object(n.jsx)(ge.a,{id:"backup-name",value:t,onChange:a,label:"Backup name",children:Object(n.jsx)(s.a,{disabled:0===t.length,onClick:async()=>{await e.saveBackup(t.trim()),a("")},children:e.backups.some((e=>e.name===t.trim()))?"Overwrite":"Save"})})))}var fe=a("ufqH"),ve=a("AFXh"),Oe=a("MKkt"),we=a("C8f0");const ke=Object(n.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:Object(n.jsx)("path",{d:"M11 15V9H5V15M5 1L4.99999 5H10M13.6667 15H2.33333C1.97971 15 1.64057 14.8595 1.39052 14.6095C1.14048 14.3594 1 14.0203 1 13.6667V2.33333C1 1.97971 1.14048 1.64057 1.39052 1.39052C1.64057 1.14048 1.97971 1 2.33333 1H11.6667L15 4.33333V13.6667C15 14.0203 14.8595 14.3594 14.6095 14.6095C14.3594 14.8595 14.0203 15 13.6667 15Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),ye=Object(n.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:Object(n.jsx)("path",{d:"M1 4L2.99999 3.99998M2.99999 3.99998V13.5C2.99999 14.3284 3.67156 15 4.49999 15L11.5 15C12.3284 15 13 14.3284 13 13.5V4M2.99999 3.99998H5.33333M13 4H15M13 4L10.6667 3.99998M5.33333 3.99998V2.5C5.33333 1.67157 6.00491 1 6.83333 1H9.16667C9.99509 1 10.6667 1.67157 10.6667 2.5V3.99998M5.33333 3.99998H10.6667",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),xe=Object(n.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:Object(n.jsx)("path",{d:"M14 10V12.6667C14 13.0203 13.8595 13.3594 13.6095 13.6095C13.3594 13.8595 13.0203 14 12.6667 14H3.33333C2.97971 14 2.64057 13.8595 2.39052 13.6095C2.14048 13.3594 2 13.0203 2 12.6667V10M4.66667 5.33333L8 2M8 2L11.3333 5.33333M8 2V10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})});function Ce(e){const{backupManager:t,backup:a}=e,o=Object(g.a)(j.a);return Object(r.b)((()=>Object(n.jsxs)(u.a,{children:[Object(n.jsxs)(b.a,{children:[Object(n.jsx)(p.a,{children:"Delete Backup"}),Object(n.jsx)(c.a,{icon:m.a,label:"Close",onClick:()=>o.dismiss()})]}),Object(n.jsx)(l.a,{children:Object(n.jsx)(te.a,{content:`Are you sure you want to delete "${a.name}"? This action cannot be undone.`})}),Object(n.jsxs)(d.a,{children:[Object(n.jsx)(i.a,{onClick:()=>o.dismiss(),children:"Cancel"}),Object(n.jsx)(s.a,{onClick:async()=>{await t.deleteBackup(a.name),o.dismiss()},children:"Delete"})]})]})))}const Me=Q.d.li.withConfig({componentId:"sc-4y1qwg-0"})(["height:48px;display:flex;align-items:center;list-style:none;border:0 solid ",";& + &{border-top-width:1px;}& > ","{margin:0;}"],(({theme:e})=>e.backgroundModifier.accent),ve.a),Be=Q.d.div.withConfig({componentId:"sc-4y1qwg-1"})(["",";flex:1;font-weight:500;"],Object(fe.b)());function De(e){const{backup:t}=e,a=Object(g.a)(ee.a),o=Object(g.a)(je);return Object(r.b)((()=>Object(n.jsxs)(Me,{children:[Object(n.jsx)(Be,{children:t.name}),Object(n.jsx)(Oe.a,{actions:[{icon:xe,label:"Load",handler:async()=>o.loadBackup(t.name)},{icon:ke,label:"Export",handler:async()=>o.exportBackup(t.name),overflow:!0},{icon:we.a,label:"Overwrite",handler:async()=>o.saveBackup(t.name),overflow:!0},{icon:ye,label:"Delete",handler:()=>a.spawn({render:()=>Object(n.jsx)(Ce,{backupManager:o,backup:t})}),overflow:!0}]})]})))}const Se=Q.d.ul.withConfig({componentId:"sc-1bbv68x-0"})(["padding:0;margin:0;max-height:420px;overflow-x:hidden;"]);function Le(){const e=Object(g.a)(je),{0:t,1:a}=Object(o.useState)("");return Object(r.b)((()=>e.backups.length>0?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(ge.a,{id:"backups-search",label:"Search Backups",value:t,onChange:a}),Object(n.jsx)(Se,{children:e.backups.filter((e=>e.name.toLocaleLowerCase().includes(t.toLocaleLowerCase()))).map((e=>Object(n.jsx)(De,{backup:e},e.id)))})]}):Object(n.jsx)(te.a,{content:"You haven't made any backups yet. Enter a name below and click on the Save button to make one."})))}function Ie(e){const{editorManager:t}=e,a=Object(h.a)((()=>new Z)),f=Object(h.a)((()=>new pe(a,t))),v=Object(g.a)(j.a),O=Object(o.useRef)(null);return Object(r.b)((()=>Object(n.jsx)(G,{value:a,children:Object(n.jsx)(he,{value:f,children:Object(n.jsxs)(u.a,{children:[Object(n.jsx)("input",{ref:O,type:"file",style:{display:"none"},onChange:async e=>{var t,a;const n=null===(t=e.target.files)||void 0===t||null===(a=t.item(0))||void 0===a?void 0:a.slice();e.target.files=null,n&&await f.importBackups(n)}}),Object(n.jsxs)(b.a,{children:[Object(n.jsx)(p.a,{children:"Backups"}),Object(n.jsx)(c.a,{icon:m.a,label:"Close",onClick:()=>v.dismiss()})]}),a.shouldShowPersistenceWarning&&Object(n.jsx)(l.a,{children:Object(n.jsx)(se,{})}),Object(n.jsx)(l.a,{children:Object(n.jsx)(Le,{})}),Object(n.jsx)(l.a,{children:Object(n.jsx)(me,{})}),Object(n.jsxs)(d.a,{children:[Object(n.jsx)(i.a,{onClick:async()=>f.exportAll(),children:"Export All"}),Object(n.jsx)(i.a,{onClick:()=>{var e;return null===(e=O.current)||void 0===e?void 0:e.click()},children:"Import"}),Object(n.jsx)(s.a,{onClick:()=>v.dismiss(),children:"Close"})]})]})})})))}}}]);
//# sourceMappingURL=207.e4c247fa6390ee3db010.js.map