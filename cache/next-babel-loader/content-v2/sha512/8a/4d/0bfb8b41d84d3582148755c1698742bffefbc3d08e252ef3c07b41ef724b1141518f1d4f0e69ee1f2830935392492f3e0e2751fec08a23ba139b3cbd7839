{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useObserver } from \"mobx-react-lite\";\nimport dynamic from \"next/dynamic\";\nimport { transparentize } from \"polished\";\nimport React, { Fragment, useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport { useWindowEvent } from \"../../common/dom/useWindowEvent\";\nimport { PrimaryButton } from \"../../common/input/button/PrimaryButton\";\nimport { SecondaryButton } from \"../../common/input/button/SecondaryButton\";\nimport { ButtonList } from \"../../common/layout/ButtonList\";\nimport { Separator } from \"../../common/layout/Separator\";\nimport { Stack } from \"../../common/layout/Stack\";\nimport { ModalManagerContext } from \"../../common/modal/ModalManagerContext\";\nimport { usePreference } from \"../../common/settings/usePreference\";\nimport { useLazyValue } from \"../../common/state/useLazyValue\";\nimport { useRequiredContext } from \"../../common/state/useRequiredContext\";\nimport { Markdown } from \"../markdown/Markdown\";\nimport { createEditorForm } from \"../message/state/editorForm\";\nimport { EditorManagerContext } from \"./EditorManagerContext\";\nimport { ClearAllConfirmationModal } from \"./message/ClearAllConfirmationModal\";\nimport { MessageEditor } from \"./message/MessageEditor\";\nimport { ShareModal } from \"./share/ShareModal\";\nimport { WebhookControls } from \"./webhook/WebhookControls\";\nconst BackupsModal = dynamic(async () => import(\"../database/backup/modal/BackupsModal\").then(module => module.BackupsModal), {\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak(\"../database/backup/modal/BackupsModal\")],\n    modules: [\"../database/backup/modal/BackupsModal\"]\n  }\n});\nconst EditorContainer = styled(Stack).withConfig({\n  componentId: \"m64dfz-0\"\n})([\"padding:16px 16px 0;\"]);\nconst JavaScriptWarning = styled.noscript.withConfig({\n  componentId: \"m64dfz-1\"\n})([\"display:block;margin-bottom:16px;padding:16px;border-radius:4px;border:2px solid \", \";background:\", \";color:\", \";font-weight:500;line-height:1.375;\"], ({\n  theme\n}) => theme.accent.danger, ({\n  theme\n}) => transparentize(0.75, theme.accent.danger), ({\n  theme\n}) => theme.header.primary);\nexport function Editor() {\n  const editorManager = useRequiredContext(EditorManagerContext);\n  const form = useLazyValue(() => createEditorForm(editorManager));\n  useEffect(() => () => form.dispose(), [form]);\n  const modalManager = useRequiredContext(ModalManagerContext);\n\n  const spawnBackupsModal = () => modalManager.spawn({\n    render: () => /*#__PURE__*/_jsx(BackupsModal, {\n      editorManager: editorManager\n    })\n  });\n\n  const spawnClearAllModal = () => modalManager.spawn({\n    render: () => /*#__PURE__*/_jsx(ClearAllConfirmationModal, {\n      editorManager: editorManager\n    })\n  });\n\n  const spawnShareModal = () => modalManager.spawn({\n    render: () => /*#__PURE__*/_jsx(ShareModal, {\n      editorManager: editorManager\n    })\n  });\n\n  const confirmExit = usePreference(\"confirmExit\");\n  useWindowEvent(\"beforeunload\", event => {\n    if (!confirmExit) return;\n    event.preventDefault();\n    event.returnValue = \"\";\n    return \"\";\n  });\n  return useObserver(() => /*#__PURE__*/_jsxs(EditorContainer, {\n    gap: 16,\n    children: [/*#__PURE__*/_jsx(JavaScriptWarning, {\n      children: /*#__PURE__*/_jsx(Markdown, {\n        content: \"It appears your web browser has prevented this page from \" + \"executing JavaScript.\\nTo use Discohook, please allow this page \" + \"to run JavaScript from your browser's settings.\"\n      })\n    }), /*#__PURE__*/_jsxs(ButtonList, {\n      children: [/*#__PURE__*/_jsx(SecondaryButton, {\n        onClick: () => spawnBackupsModal(),\n        children: \"Backups\"\n      }), /*#__PURE__*/_jsx(SecondaryButton, {\n        onClick: () => spawnClearAllModal(),\n        children: \"Clear All\"\n      }), /*#__PURE__*/_jsx(SecondaryButton, {\n        onClick: () => spawnShareModal(),\n        children: \"Share Message\"\n      })]\n    }), /*#__PURE__*/_jsx(WebhookControls, {\n      form: form\n    }), editorManager.messages.map((message, index) => /*#__PURE__*/_jsxs(Fragment, {\n      children: [/*#__PURE__*/_jsx(Separator, {}), /*#__PURE__*/_jsx(MessageEditor, {\n        message: message,\n        form: form.repeatingForm(\"messages\").index(index)\n      })]\n    }, message.id)), /*#__PURE__*/_jsx(Separator, {}), /*#__PURE__*/_jsx(\"div\", {\n      children: /*#__PURE__*/_jsx(PrimaryButton, {\n        onClick: () => {\n          form.repeatingForm(\"messages\").push({});\n        },\n        children: \"Add Message\"\n      })\n    })]\n  }));\n}","map":null,"metadata":{},"sourceType":"module"}