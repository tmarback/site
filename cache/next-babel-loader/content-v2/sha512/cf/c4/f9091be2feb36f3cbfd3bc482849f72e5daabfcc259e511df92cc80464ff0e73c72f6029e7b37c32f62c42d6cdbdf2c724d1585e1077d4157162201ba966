{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useObserver } from \"mobx-react-lite\";\nimport dynamic from \"next/dynamic\";\nimport { transparentize } from \"polished\";\nimport React, { Fragment, useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport { useWindowEvent } from \"../../common/dom/useWindowEvent\";\nimport { PrimaryButton } from \"../../common/input/button/PrimaryButton\";\nimport { SecondaryButton } from \"../../common/input/button/SecondaryButton\";\nimport { ButtonList } from \"../../common/layout/ButtonList\";\nimport { Separator } from \"../../common/layout/Separator\";\nimport { Stack } from \"../../common/layout/Stack\";\nimport { ModalManagerContext } from \"../../common/modal/ModalManagerContext\";\nimport { usePreference } from \"../../common/settings/usePreference\";\nimport { useLazyValue } from \"../../common/state/useLazyValue\";\nimport { useRequiredContext } from \"../../common/state/useRequiredContext\";\nimport { Markdown } from \"../markdown/Markdown\";\nimport { createEditorForm } from \"../message/state/editorForm\";\nimport { EditorManagerContext } from \"./EditorManagerContext\";\nimport { ClearAllConfirmationModal } from \"./message/ClearAllConfirmationModal\";\nimport { MessageEditor } from \"./message/MessageEditor\";\nimport { ShareModal } from \"./share/ShareModal\";\nimport { WebhookControls } from \"./webhook/WebhookControls\";\nconst BackupsModal = dynamic(async () => import(\"../database/backup/modal/BackupsModal\").then(module => module.BackupsModal), {\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak(\"../database/backup/modal/BackupsModal\")],\n    modules: [\"../database/backup/modal/BackupsModal\"]\n  }\n});\nconst EditorContainer = styled(Stack).withConfig({\n  componentId: \"m64dfz-0\"\n})([\"padding:16px 16px 0;\"]);\nconst JavaScriptWarning = styled.noscript.withConfig({\n  componentId: \"m64dfz-1\"\n})([\"display:block;margin-bottom:16px;padding:16px;border-radius:4px;border:2px solid \", \";background:\", \";color:\", \";font-weight:500;line-height:1.375;\"], ({\n  theme\n}) => theme.accent.danger, ({\n  theme\n}) => transparentize(0.75, theme.accent.danger), ({\n  theme\n}) => theme.header.primary);\nexport function Editor() {\n  const editorManager = useRequiredContext(EditorManagerContext);\n  const form = useLazyValue(() => createEditorForm(editorManager));\n  useEffect(() => () => form.dispose(), [form]);\n  const modalManager = useRequiredContext(ModalManagerContext);\n\n  const spawnBackupsModal = () => modalManager.spawn({\n    render: () => /*#__PURE__*/_jsx(BackupsModal, {\n      editorManager: editorManager\n    })\n  });\n\n  const spawnClearAllModal = () => modalManager.spawn({\n    render: () => /*#__PURE__*/_jsx(ClearAllConfirmationModal, {\n      editorManager: editorManager\n    })\n  });\n\n  const spawnShareModal = () => modalManager.spawn({\n    render: () => /*#__PURE__*/_jsx(ShareModal, {\n      editorManager: editorManager\n    })\n  });\n\n  const confirmExit = usePreference(\"confirmExit\");\n  useWindowEvent(\"beforeunload\", event => {\n    if (!confirmExit) return;\n    event.preventDefault();\n    event.returnValue = \"\";\n    return \"\";\n  });\n  return useObserver(() => /*#__PURE__*/_jsxs(EditorContainer, {\n    gap: 16,\n    children: [/*#__PURE__*/_jsx(JavaScriptWarning, {\n      children: /*#__PURE__*/_jsx(Markdown, {\n        content: \"It appears your web browser has prevented this page from \" + \"executing JavaScript.\\nTo use Discohook, please allow this page \" + \"to run JavaScript from your browser's settings.\"\n      })\n    }), /*#__PURE__*/_jsxs(ButtonList, {\n      children: [/*#__PURE__*/_jsx(SecondaryButton, {\n        onClick: () => spawnBackupsModal(),\n        children: \"Backups\"\n      }), /*#__PURE__*/_jsx(SecondaryButton, {\n        onClick: () => spawnClearAllModal(),\n        children: \"Clear All\"\n      }), /*#__PURE__*/_jsx(SecondaryButton, {\n        onClick: () => spawnShareModal(),\n        children: \"Share Message\"\n      })]\n    }), /*#__PURE__*/_jsx(WebhookControls, {\n      form: form\n    }), editorManager.messages.map((message, index) => /*#__PURE__*/_jsxs(Fragment, {\n      children: [/*#__PURE__*/_jsx(Separator, {}), /*#__PURE__*/_jsx(MessageEditor, {\n        message: message,\n        form: form.repeatingForm(\"messages\").index(index)\n      })]\n    }, message.id)), /*#__PURE__*/_jsx(Separator, {}), /*#__PURE__*/_jsx(\"div\", {\n      children: /*#__PURE__*/_jsx(PrimaryButton, {\n        onClick: () => {\n          form.repeatingForm(\"messages\").push({});\n        },\n        children: \"Add Message\"\n      })\n    })]\n  }));\n}","map":{"version":3,"sources":["/home/runner/work/site/site/modules/editor/Editor.tsx"],"names":["useObserver","dynamic","transparentize","React","Fragment","useEffect","styled","useWindowEvent","PrimaryButton","SecondaryButton","ButtonList","Separator","Stack","ModalManagerContext","usePreference","useLazyValue","useRequiredContext","Markdown","createEditorForm","EditorManagerContext","ClearAllConfirmationModal","MessageEditor","ShareModal","WebhookControls","BackupsModal","then","module","EditorContainer","JavaScriptWarning","noscript","theme","accent","danger","header","primary","Editor","editorManager","form","dispose","modalManager","spawnBackupsModal","spawn","render","spawnClearAllModal","spawnShareModal","confirmExit","event","preventDefault","returnValue","messages","map","message","index","repeatingForm","id","push"],"mappings":"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","sourcesContent":["import { useObserver } from \"mobx-react-lite\"\nimport dynamic from \"next/dynamic\"\nimport { transparentize } from \"polished\"\nimport React, { Fragment, useEffect } from \"react\"\nimport styled from \"styled-components\"\nimport { useWindowEvent } from \"../../common/dom/useWindowEvent\"\nimport { PrimaryButton } from \"../../common/input/button/PrimaryButton\"\nimport { SecondaryButton } from \"../../common/input/button/SecondaryButton\"\nimport { ButtonList } from \"../../common/layout/ButtonList\"\nimport { Separator } from \"../../common/layout/Separator\"\nimport { Stack } from \"../../common/layout/Stack\"\nimport { ModalManagerContext } from \"../../common/modal/ModalManagerContext\"\nimport { usePreference } from \"../../common/settings/usePreference\"\nimport { useLazyValue } from \"../../common/state/useLazyValue\"\nimport { useRequiredContext } from \"../../common/state/useRequiredContext\"\nimport type { BackupsModalProps } from \"../database/backup/modal/BackupsModal\"\nimport { Markdown } from \"../markdown/Markdown\"\nimport { createEditorForm } from \"../message/state/editorForm\"\nimport type { MessageLike } from \"../message/state/models/MessageModel\"\nimport { EditorManagerContext } from \"./EditorManagerContext\"\nimport { ClearAllConfirmationModal } from \"./message/ClearAllConfirmationModal\"\nimport { MessageEditor } from \"./message/MessageEditor\"\nimport { ShareModal } from \"./share/ShareModal\"\nimport { WebhookControls } from \"./webhook/WebhookControls\"\n\nconst BackupsModal = dynamic<BackupsModalProps>(async () =>\n  import(\"../database/backup/modal/BackupsModal\").then(\n    module => module.BackupsModal,\n  ),\n)\n\nconst EditorContainer = styled(Stack)`\n  padding: 16px 16px 0;\n`\n\nconst JavaScriptWarning = styled.noscript`\n  display: block;\n\n  margin-bottom: 16px;\n  padding: 16px;\n  border-radius: 4px;\n\n  border: 2px solid ${({ theme }) => theme.accent.danger};\n  background: ${({ theme }) => transparentize(0.75, theme.accent.danger)};\n\n  color: ${({ theme }) => theme.header.primary};\n  font-weight: 500;\n  line-height: 1.375;\n`\n\nexport function Editor() {\n  const editorManager = useRequiredContext(EditorManagerContext)\n\n  const form = useLazyValue(() => createEditorForm(editorManager))\n  useEffect(() => () => form.dispose(), [form])\n\n  const modalManager = useRequiredContext(ModalManagerContext)\n\n  const spawnBackupsModal = () =>\n    modalManager.spawn({\n      render: () => <BackupsModal editorManager={editorManager} />,\n    })\n\n  const spawnClearAllModal = () =>\n    modalManager.spawn({\n      render: () => <ClearAllConfirmationModal editorManager={editorManager} />,\n    })\n\n  const spawnShareModal = () =>\n    modalManager.spawn({\n      render: () => <ShareModal editorManager={editorManager} />,\n    })\n\n  const confirmExit = usePreference(\"confirmExit\")\n  useWindowEvent(\"beforeunload\", event => {\n    if (!confirmExit) return\n\n    event.preventDefault()\n    event.returnValue = \"\"\n    return \"\"\n  })\n\n  return useObserver(() => (\n    <EditorContainer gap={16}>\n      <JavaScriptWarning>\n        <Markdown\n          content={\n            \"It appears your web browser has prevented this page from \" +\n            \"executing JavaScript.\\nTo use Discohook, please allow this page \" +\n            \"to run JavaScript from your browser's settings.\"\n          }\n        />\n      </JavaScriptWarning>\n      <ButtonList>\n        <SecondaryButton onClick={() => spawnBackupsModal()}>\n          Backups\n        </SecondaryButton>\n        <SecondaryButton onClick={() => spawnClearAllModal()}>\n          Clear All\n        </SecondaryButton>\n        <SecondaryButton onClick={() => spawnShareModal()}>\n          Share Message\n        </SecondaryButton>\n      </ButtonList>\n      <WebhookControls form={form} />\n      {editorManager.messages.map((message, index) => (\n        <Fragment key={message.id}>\n          <Separator />\n          <MessageEditor\n            message={message}\n            form={form.repeatingForm(\"messages\").index(index)}\n          />\n        </Fragment>\n      ))}\n      <Separator />\n      <div>\n        <PrimaryButton\n          onClick={() => {\n            form.repeatingForm(\"messages\").push({} as MessageLike)\n          }}\n        >\n          Add Message\n        </PrimaryButton>\n      </div>\n    </EditorContainer>\n  ))\n}\n"]},"metadata":{},"sourceType":"module"}