{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useObserver } from \"mobx-react-lite\";\nimport React, { useRef } from \"react\";\nimport { PrimaryButton } from \"../../../../common/input/button/PrimaryButton\";\nimport { SecondaryButton } from \"../../../../common/input/button/SecondaryButton\";\nimport { ModalAction } from \"../../../../common/modal/layout/ModalAction\";\nimport { ModalBody } from \"../../../../common/modal/layout/ModalBody\";\nimport { ModalContainer } from \"../../../../common/modal/layout/ModalContainer\";\nimport { ModalFooter } from \"../../../../common/modal/layout/ModalFooter\";\nimport { ModalHeader } from \"../../../../common/modal/layout/ModalHeader\";\nimport { ModalTitle } from \"../../../../common/modal/layout/ModalTitle\";\nimport { ModalContext } from \"../../../../common/modal/ModalContext\";\nimport { useLazyValue } from \"../../../../common/state/useLazyValue\";\nimport { useRequiredContext } from \"../../../../common/state/useRequiredContext\";\nimport { remove } from \"../../../../icons/remove\";\nimport { DatabaseManager } from \"../../DatabaseManager\";\nimport { DatabaseManagerProvider } from \"../../DatabaseManagerContext\";\nimport { PersistentStorageWarning } from \"../../persist/PersistentStorageWarning\";\nimport { BackupManager } from \"../BackupManager\";\nimport { BackupManagerProvider } from \"../BackupManagerContext\";\nimport { BackupCreationControls } from \"./BackupCreationControls\";\nimport { BackupList } from \"./BackupList\";\nexport function BackupsModal(props) {\n  const {\n    editorManager\n  } = props;\n  const databaseManager = useLazyValue(() => new DatabaseManager());\n  const backupManager = useLazyValue(() => new BackupManager(databaseManager, editorManager));\n  const modal = useRequiredContext(ModalContext);\n  const fileInputRef = useRef(null);\n  return useObserver(() => /*#__PURE__*/_jsx(DatabaseManagerProvider, {\n    value: databaseManager,\n    children: /*#__PURE__*/_jsx(BackupManagerProvider, {\n      value: backupManager,\n      children: /*#__PURE__*/_jsxs(ModalContainer, {\n        children: [/*#__PURE__*/_jsx(\"input\", {\n          ref: fileInputRef,\n          type: \"file\",\n          style: {\n            display: \"none\"\n          },\n          onChange: async event => {\n            var _event$target$files, _event$target$files$i;\n\n            const file = (_event$target$files = event.target.files) === null || _event$target$files === void 0 ? void 0 : (_event$target$files$i = _event$target$files.item(0)) === null || _event$target$files$i === void 0 ? void 0 : _event$target$files$i.slice();\n            event.target.files = null;\n\n            if (file) {\n              await backupManager.importBackups(file);\n            }\n          }\n        }), /*#__PURE__*/_jsxs(ModalHeader, {\n          children: [/*#__PURE__*/_jsx(ModalTitle, {\n            children: \"Backups\"\n          }), /*#__PURE__*/_jsx(ModalAction, {\n            icon: remove,\n            label: \"Close\",\n            onClick: () => modal.dismiss()\n          })]\n        }), databaseManager.shouldShowPersistenceWarning && /*#__PURE__*/_jsx(ModalBody, {\n          children: /*#__PURE__*/_jsx(PersistentStorageWarning, {})\n        }), /*#__PURE__*/_jsx(ModalBody, {\n          children: /*#__PURE__*/_jsx(BackupList, {})\n        }), /*#__PURE__*/_jsx(ModalBody, {\n          children: /*#__PURE__*/_jsx(BackupCreationControls, {})\n        }), /*#__PURE__*/_jsxs(ModalFooter, {\n          children: [/*#__PURE__*/_jsx(SecondaryButton, {\n            onClick: async () => backupManager.exportAll(),\n            children: \"Export All\"\n          }), /*#__PURE__*/_jsx(SecondaryButton, {\n            onClick: () => {\n              var _fileInputRef$current;\n\n              return (_fileInputRef$current = fileInputRef.current) === null || _fileInputRef$current === void 0 ? void 0 : _fileInputRef$current.click();\n            },\n            children: \"Import\"\n          }), /*#__PURE__*/_jsx(PrimaryButton, {\n            onClick: () => modal.dismiss(),\n            children: \"Close\"\n          })]\n        })]\n      })\n    })\n  }));\n}","map":null,"metadata":{},"sourceType":"module"}