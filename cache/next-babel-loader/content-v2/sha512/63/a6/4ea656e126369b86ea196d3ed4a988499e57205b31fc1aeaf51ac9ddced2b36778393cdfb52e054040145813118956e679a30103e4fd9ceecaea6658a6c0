{"ast":null,"code":"import { ColorModel } from \"../../../common/input/color/ColorModel\";\nexport const messageOf = data => {\n  var _data$content, _data$username, _data$avatar_url;\n\n  const snapshot = {};\n  snapshot.content = (_data$content = data.content) !== null && _data$content !== void 0 ? _data$content : \"\";\n  snapshot.username = (_data$username = data.username) !== null && _data$username !== void 0 ? _data$username : \"\";\n  snapshot.avatar = (_data$avatar_url = data.avatar_url) !== null && _data$avatar_url !== void 0 ? _data$avatar_url : \"\";\n  const embeds = [];\n  snapshot.embeds = embeds;\n\n  for (const embedData of (_data$embeds = data.embeds) !== null && _data$embeds !== void 0 ? _data$embeds : []) {\n    var _data$embeds, _embed, _embedData$title, _embedData$descriptio, _embedData$url, _embedData$author$nam, _embedData$author, _embedData$author$url, _embedData$author2, _embedData$author$ico, _embedData$author3, _embedData$footer$tex, _embedData$footer, _embedData$footer$ico, _embedData$footer2, _embedData$timestamp, _embedData$image$url, _embedData$image2, _embedData$thumbnail$, _embedData$thumbnail, _embedData$color;\n\n    let embed = embeds.length > 0 ? embeds[embeds.length - 1] : undefined;\n\n    if ((_embed = embed) !== null && _embed !== void 0 && _embed.url && embed.url === embedData.url) {\n      var _embedData$image;\n\n      const gallery = embed.gallery;\n\n      if ((_embedData$image = embedData.image) !== null && _embedData$image !== void 0 && _embedData$image.url && gallery.length < 4) {\n        gallery.push(embedData.image.url);\n      }\n\n      continue;\n    }\n\n    embed = {};\n    embeds.push(embed);\n    embed.title = (_embedData$title = embedData.title) !== null && _embedData$title !== void 0 ? _embedData$title : \"\";\n    embed.description = (_embedData$descriptio = embedData.description) !== null && _embedData$descriptio !== void 0 ? _embedData$descriptio : \"\";\n    embed.url = (_embedData$url = embedData.url) !== null && _embedData$url !== void 0 ? _embedData$url : \"\";\n    embed.author = (_embedData$author$nam = (_embedData$author = embedData.author) === null || _embedData$author === void 0 ? void 0 : _embedData$author.name) !== null && _embedData$author$nam !== void 0 ? _embedData$author$nam : \"\";\n    embed.authorUrl = (_embedData$author$url = (_embedData$author2 = embedData.author) === null || _embedData$author2 === void 0 ? void 0 : _embedData$author2.url) !== null && _embedData$author$url !== void 0 ? _embedData$author$url : \"\";\n    embed.authorIcon = (_embedData$author$ico = (_embedData$author3 = embedData.author) === null || _embedData$author3 === void 0 ? void 0 : _embedData$author3.icon_url) !== null && _embedData$author$ico !== void 0 ? _embedData$author$ico : \"\";\n    embed.footer = (_embedData$footer$tex = (_embedData$footer = embedData.footer) === null || _embedData$footer === void 0 ? void 0 : _embedData$footer.text) !== null && _embedData$footer$tex !== void 0 ? _embedData$footer$tex : \"\";\n    embed.footerIcon = (_embedData$footer$ico = (_embedData$footer2 = embedData.footer) === null || _embedData$footer2 === void 0 ? void 0 : _embedData$footer2.icon_url) !== null && _embedData$footer$ico !== void 0 ? _embedData$footer$ico : \"\";\n    embed.timestamp = new Date((_embedData$timestamp = embedData.timestamp) !== null && _embedData$timestamp !== void 0 ? _embedData$timestamp : Number.NaN);\n    embed.gallery = [(_embedData$image$url = (_embedData$image2 = embedData.image) === null || _embedData$image2 === void 0 ? void 0 : _embedData$image2.url) !== null && _embedData$image$url !== void 0 ? _embedData$image$url : \"\"].filter(Boolean);\n    embed.thumbnail = (_embedData$thumbnail$ = (_embedData$thumbnail = embedData.thumbnail) === null || _embedData$thumbnail === void 0 ? void 0 : _embedData$thumbnail.url) !== null && _embedData$thumbnail$ !== void 0 ? _embedData$thumbnail$ : \"\";\n    const color = ColorModel.create();\n    color.setRaw((_embedData$color = embedData.color) !== null && _embedData$color !== void 0 ? _embedData$color : null);\n    embed.color = color;\n    const fields = [];\n    embed.fields = fields;\n\n    for (const fieldData of (_embedData$fields = embedData.fields) !== null && _embedData$fields !== void 0 ? _embedData$fields : []) {\n      var _embedData$fields, _fieldData$name, _fieldData$value, _fieldData$inline;\n\n      const field = {};\n      fields.push(field);\n      field.name = (_fieldData$name = fieldData.name) !== null && _fieldData$name !== void 0 ? _fieldData$name : \"\";\n      field.value = (_fieldData$value = fieldData.value) !== null && _fieldData$value !== void 0 ? _fieldData$value : \"\";\n      field.inline = (_fieldData$inline = fieldData.inline) !== null && _fieldData$inline !== void 0 ? _fieldData$inline : false;\n    }\n  }\n\n  return snapshot;\n};","map":{"version":3,"sources":["/home/runner/work/site/site/modules/message/helpers/messageOf.ts"],"names":["ColorModel","messageOf","data","snapshot","content","username","avatar","avatar_url","embeds","embedData","embed","length","undefined","url","gallery","image","push","title","description","author","name","authorUrl","authorIcon","icon_url","footer","text","footerIcon","timestamp","Date","Number","NaN","filter","Boolean","thumbnail","color","create","setRaw","fields","fieldData","field","value","inline"],"mappings":"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","sourcesContent":["import type { SnapshotIn } from \"mobx-state-tree\"\nimport { ColorModel } from \"../../../common/input/color/ColorModel\"\nimport type { MessageData } from \"../state/data/MessageData\"\nimport type { MessageModel } from \"../state/models/MessageModel\"\n\nexport const messageOf = (data: MessageData) => {\n  const snapshot: Record<string, unknown> = {}\n\n  snapshot.content = data.content ?? \"\"\n  snapshot.username = data.username ?? \"\"\n  snapshot.avatar = data.avatar_url ?? \"\"\n\n  const embeds: Record<string, unknown>[] = []\n  snapshot.embeds = embeds\n\n  for (const embedData of data.embeds ?? []) {\n    let embed = embeds.length > 0 ? embeds[embeds.length - 1] : undefined\n\n    if (embed?.url && embed.url === embedData.url) {\n      const gallery = embed.gallery as string[]\n      if (embedData.image?.url && gallery.length < 4) {\n        gallery.push(embedData.image.url)\n      }\n\n      continue\n    }\n\n    embed = {}\n    embeds.push(embed)\n\n    embed.title = embedData.title ?? \"\"\n    embed.description = embedData.description ?? \"\"\n    embed.url = embedData.url ?? \"\"\n    embed.author = embedData.author?.name ?? \"\"\n    embed.authorUrl = embedData.author?.url ?? \"\"\n    embed.authorIcon = embedData.author?.icon_url ?? \"\"\n    embed.footer = embedData.footer?.text ?? \"\"\n    embed.footerIcon = embedData.footer?.icon_url ?? \"\"\n    embed.timestamp = new Date(embedData.timestamp ?? Number.NaN)\n    embed.gallery = [embedData.image?.url ?? \"\"].filter(Boolean)\n    embed.thumbnail = embedData.thumbnail?.url ?? \"\"\n\n    const color = ColorModel.create()\n    color.setRaw(embedData.color ?? null)\n    embed.color = color\n\n    const fields: Record<string, unknown>[] = []\n    embed.fields = fields\n\n    for (const fieldData of embedData.fields ?? []) {\n      const field: Record<string, unknown> = {}\n      fields.push(field)\n\n      field.name = fieldData.name ?? \"\"\n      field.value = fieldData.value ?? \"\"\n      field.inline = fieldData.inline ?? false\n    }\n  }\n\n  return snapshot as SnapshotIn<typeof MessageModel>\n}\n"]},"metadata":{},"sourceType":"module"}