{"ast":null,"code":"import _defineProperty from \"/home/runner/work/site/site/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useObserver } from \"mobx-react-lite\";\nimport { applySnapshot } from \"mobx-state-tree\";\nimport React, { useState } from \"react\";\nimport styled from \"styled-components\";\nimport { copyTextToClipboard } from \"../../../common/dom/copyTextToClipboard\";\nimport { PrimaryButton } from \"../../../common/input/button/PrimaryButton\";\nimport { SecondaryButton } from \"../../../common/input/button/SecondaryButton\";\nimport { Input } from \"../../../common/input/layout/Input\";\nimport { ModalAction } from \"../../../common/modal/layout/ModalAction\";\nimport { ModalBody } from \"../../../common/modal/layout/ModalBody\";\nimport { ModalContainer } from \"../../../common/modal/layout/ModalContainer\";\nimport { ModalFooter } from \"../../../common/modal/layout/ModalFooter\";\nimport { ModalHeader } from \"../../../common/modal/layout/ModalHeader\";\nimport { ModalTitle } from \"../../../common/modal/layout/ModalTitle\";\nimport { ModalContext } from \"../../../common/modal/ModalContext\";\nimport { parseJson } from \"../../../common/object/parseJson\";\nimport { useRequiredContext } from \"../../../common/state/useRequiredContext\";\nimport { remove } from \"../../../icons/remove\";\nimport { messageOf } from \"../../message/helpers/messageOf\";\nimport { stringifyMessage } from \"../../message/helpers/stringifyMessage\";\nimport { isMessage } from \"./validation/isMessage\";\nconst Container = styled(ModalContainer).withConfig({\n  componentId: \"cbip1o-0\"\n})([\"width:1024px;height:768px;display:flex;flex-flow:column;\"]);\nconst Body = styled(ModalBody).withConfig({\n  componentId: \"cbip1o-1\"\n})([\"flex:1;display:flex;flex-flow:column;\"]);\nconst CodeInput = styled(Input).withConfig({\n  componentId: \"cbip1o-2\"\n})([\"&&{width:100%;resize:none;}flex:1;font-family:\", \";font-size:14px;line-height:1.375;overflow-y:auto;\"], ({\n  theme\n}) => theme.font.mono);\nconst ErrorContainer = styled.div.withConfig({\n  componentId: \"cbip1o-3\"\n})([\"margin-top:8px;max-height:max(20%,96px);overflow-y:auto;\"]);\nconst ErrorLine = styled.code.withConfig({\n  componentId: \"cbip1o-4\"\n})([\"display:block;color:\", \";font-size:14px;line-height:1.375;& + &{margin-top:8px;}\"], ({\n  theme\n}) => theme.accent.danger);\nexport function DataEditorModal(props) {\n  const {\n    message\n  } = props;\n  const modal = useRequiredContext(ModalContext);\n  const {\n    0: value,\n    1: setValue\n  } = useState(() => stringifyMessage(message.data));\n  const {\n    value: data,\n    error\n  } = parseJson(value);\n  const errors = error ? [error] : isMessage(data, \"$\");\n  return useObserver(() => /*#__PURE__*/_jsxs(Container, {\n    children: [/*#__PURE__*/_jsxs(ModalHeader, {\n      children: [/*#__PURE__*/_jsx(ModalTitle, {\n        children: \"JSON Editor\"\n      }), /*#__PURE__*/_jsx(ModalAction, {\n        icon: remove,\n        label: \"Close\",\n        onClick: () => modal.dismiss()\n      })]\n    }), /*#__PURE__*/_jsxs(Body, {\n      children: [/*#__PURE__*/_jsx(CodeInput, {\n        as: \"textarea\",\n        id: \"data-editor\",\n        value: value,\n        onChange: event => {\n          setValue(event.target.value);\n        }\n      }), errors.length > 0 && /*#__PURE__*/_jsx(ErrorContainer, {\n        children: errors.map((error, index) =>\n        /*#__PURE__*/\n        // eslint-disable-next-line react/no-array-index-key\n        _jsx(ErrorLine, {\n          children: error\n        }, index))\n      })]\n    }), /*#__PURE__*/_jsxs(ModalFooter, {\n      children: [/*#__PURE__*/_jsx(SecondaryButton, {\n        onClick: () => copyTextToClipboard(value),\n        children: \"Copy to Clipboard\"\n      }), /*#__PURE__*/_jsx(SecondaryButton, {\n        onClick: () => modal.dismiss(),\n        children: \"Cancel\"\n      }), /*#__PURE__*/_jsx(PrimaryButton, {\n        disabled: errors.length > 0,\n        onClick: () => {\n          applySnapshot(message, _objectSpread(_objectSpread({}, messageOf(JSON.parse(value))), {}, {\n            id: message.id\n          }));\n          modal.dismiss();\n        },\n        children: \"Apply Changes\"\n      })]\n    })]\n  }));\n}","map":{"version":3,"sources":["/home/runner/work/site/site/modules/editor/data/DataEditorModal.tsx"],"names":["useObserver","applySnapshot","React","useState","styled","copyTextToClipboard","PrimaryButton","SecondaryButton","Input","ModalAction","ModalBody","ModalContainer","ModalFooter","ModalHeader","ModalTitle","ModalContext","parseJson","useRequiredContext","remove","messageOf","stringifyMessage","isMessage","Container","Body","CodeInput","theme","font","mono","ErrorContainer","div","ErrorLine","code","accent","danger","DataEditorModal","props","message","modal","value","setValue","data","error","errors","dismiss","event","target","length","map","index","JSON","parse","id"],"mappings":"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","sourcesContent":["import { useObserver } from \"mobx-react-lite\"\nimport { applySnapshot } from \"mobx-state-tree\"\nimport React, { ChangeEvent, useState } from \"react\"\nimport styled from \"styled-components\"\nimport { copyTextToClipboard } from \"../../../common/dom/copyTextToClipboard\"\nimport { PrimaryButton } from \"../../../common/input/button/PrimaryButton\"\nimport { SecondaryButton } from \"../../../common/input/button/SecondaryButton\"\nimport { Input } from \"../../../common/input/layout/Input\"\nimport { ModalAction } from \"../../../common/modal/layout/ModalAction\"\nimport { ModalBody } from \"../../../common/modal/layout/ModalBody\"\nimport { ModalContainer } from \"../../../common/modal/layout/ModalContainer\"\nimport { ModalFooter } from \"../../../common/modal/layout/ModalFooter\"\nimport { ModalHeader } from \"../../../common/modal/layout/ModalHeader\"\nimport { ModalTitle } from \"../../../common/modal/layout/ModalTitle\"\nimport { ModalContext } from \"../../../common/modal/ModalContext\"\nimport { parseJson } from \"../../../common/object/parseJson\"\nimport { useRequiredContext } from \"../../../common/state/useRequiredContext\"\nimport { remove } from \"../../../icons/remove\"\nimport { messageOf } from \"../../message/helpers/messageOf\"\nimport { stringifyMessage } from \"../../message/helpers/stringifyMessage\"\nimport type { MessageLike } from \"../../message/state/models/MessageModel\"\nimport { isMessage } from \"./validation/isMessage\"\n\nconst Container = styled(ModalContainer)`\n  width: 1024px;\n  height: 768px;\n\n  display: flex;\n  flex-flow: column;\n`\n\nconst Body = styled(ModalBody)`\n  flex: 1;\n\n  display: flex;\n  flex-flow: column;\n`\n\nconst CodeInput = styled(Input)`\n  && {\n    width: 100%;\n    resize: none;\n  }\n\n  flex: 1;\n\n  font-family: ${({ theme }) => theme.font.mono};\n  font-size: 14px;\n  line-height: 1.375;\n\n  overflow-y: auto;\n`\n\nconst ErrorContainer = styled.div`\n  margin-top: 8px;\n\n  max-height: max(20%, 96px);\n  overflow-y: auto;\n`\n\nconst ErrorLine = styled.code`\n  display: block;\n\n  color: ${({ theme }) => theme.accent.danger};\n  font-size: 14px;\n  line-height: 1.375;\n\n  & + & {\n    margin-top: 8px;\n  }\n`\n\nexport type DataEditorModalProps = {\n  message: MessageLike\n}\n\nexport function DataEditorModal(props: DataEditorModalProps) {\n  const { message } = props\n\n  const modal = useRequiredContext(ModalContext)\n\n  const [value, setValue] = useState(() => stringifyMessage(message.data))\n\n  const { value: data, error } = parseJson(value)\n  const errors = error ? [error] : isMessage(data, \"$\")\n\n  return useObserver(() => (\n    <Container>\n      <ModalHeader>\n        <ModalTitle>JSON Editor</ModalTitle>\n        <ModalAction\n          icon={remove}\n          label=\"Close\"\n          onClick={() => modal.dismiss()}\n        />\n      </ModalHeader>\n      <Body>\n        <CodeInput\n          as=\"textarea\"\n          id=\"data-editor\"\n          value={value}\n          onChange={(event: ChangeEvent<HTMLTextAreaElement>) => {\n            setValue(event.target.value)\n          }}\n        />\n        {errors.length > 0 && (\n          <ErrorContainer>\n            {errors.map((error, index) => (\n              // eslint-disable-next-line react/no-array-index-key\n              <ErrorLine key={index}>{error}</ErrorLine>\n            ))}\n          </ErrorContainer>\n        )}\n      </Body>\n      <ModalFooter>\n        <SecondaryButton onClick={() => copyTextToClipboard(value)}>\n          Copy to Clipboard\n        </SecondaryButton>\n        <SecondaryButton onClick={() => modal.dismiss()}>\n          Cancel\n        </SecondaryButton>\n        <PrimaryButton\n          disabled={errors.length > 0}\n          onClick={() => {\n            applySnapshot(message, {\n              ...messageOf(JSON.parse(value)),\n              id: message.id,\n            })\n            modal.dismiss()\n          }}\n        >\n          Apply Changes\n        </PrimaryButton>\n      </ModalFooter>\n    </Container>\n  ))\n}\n"]},"metadata":{},"sourceType":"module"}