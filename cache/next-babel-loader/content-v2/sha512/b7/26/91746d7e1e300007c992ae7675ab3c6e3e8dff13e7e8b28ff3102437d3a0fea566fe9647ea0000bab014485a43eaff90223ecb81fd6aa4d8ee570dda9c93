{"ast":null,"code":"/* eslint-disable import/no-cycle */\nimport { isValid } from \"date-fns\";\nimport { getParentOfType, types } from \"mobx-state-tree\";\nimport { ColorModel } from \"../../../../common/input/color/ColorModel\";\nimport { nullableDate } from \"../../../../common/state/nullableDate\";\nimport { getUniqueId } from \"../../../../common/state/uid\";\nimport { FieldModel } from \"./FieldModel\";\nimport { MessageModel } from \"./MessageModel\";\nexport const EmbedModel = types.model(\"EmbedModel\", {\n  id: types.optional(types.identifierNumber, getUniqueId),\n  title: \"\",\n  description: \"\",\n  url: \"\",\n  color: types.optional(ColorModel, {}),\n  fields: types.array(types.late(() => FieldModel)),\n  author: \"\",\n  authorUrl: \"\",\n  authorIcon: \"\",\n  footer: \"\",\n  footerIcon: \"\",\n  timestamp: types.optional(nullableDate, null),\n  gallery: types.array(types.string),\n  thumbnail: \"\"\n}).views(self => ({\n  get message() {\n    return getParentOfType(self, MessageModel);\n  },\n\n  get length() {\n    return self.title.length + self.description.length + self.fields.reduce((length, field) => length + field.name.length + field.value.length, 0) + self.author.length + self.footer.length;\n  },\n\n  get size() {\n    return Math.max(self.gallery.length, 1);\n  },\n\n  get hasTitle() {\n    return self.title.trim().length > 0;\n  },\n\n  get hasDescription() {\n    return self.description.trim().length > 0;\n  },\n\n  get hasAuthor() {\n    return self.author.trim().length > 0;\n  },\n\n  get hasFooter() {\n    return self.footer.trim().length > 0 || isValid(self.timestamp);\n  },\n\n  get data() {\n    const fields = self.fields.length > 0 ? self.fields.map(field => ({\n      name: field.name || undefined,\n      value: field.value || undefined,\n      inline: field.inline || undefined\n    })) : undefined;\n    const author = this.hasAuthor ? {\n      name: self.author,\n      url: self.authorUrl || undefined,\n      icon_url: self.authorIcon || undefined\n    } : undefined;\n    const footer = self.footer.trim().length > 0 || isValid(self.timestamp) && self.footerIcon ? {\n      text: self.footer || undefined,\n      icon_url: self.footerIcon || undefined\n    } : undefined;\n    const embeds = [{\n      title: self.title || undefined,\n      description: self.description || undefined,\n      url: self.url || undefined,\n      color: self.color.raw,\n      fields,\n      author,\n      footer,\n      timestamp: isValid(self.timestamp) ? self.timestamp.toJSON() : undefined,\n      image: self.gallery.length > 0 ? {\n        url: self.gallery[0]\n      } : undefined,\n      thumbnail: self.thumbnail ? {\n        url: self.thumbnail\n      } : undefined\n    }];\n\n    for (const image of self.gallery.slice(1)) {\n      embeds.push({\n        url: self.url,\n        image: {\n          url: image\n        }\n      });\n    }\n\n    return embeds;\n  },\n\n  get displayName() {\n    /* eslint-disable @typescript-eslint/prefer-nullish-coalescing */\n    return self.author.split(\"\\n\").map(line => line.trim()).find(Boolean) || self.title.split(\"\\n\").map(line => line.trim()).find(Boolean) || self.description.split(\"\\n\").map(line => line.trim()).find(Boolean) || self.fields.map(field => field.displayName).find(Boolean) || self.footer.split(\"\\n\").map(line => line.trim()).find(Boolean) || undefined;\n    /* eslint-enable @typescript-eslint/prefer-nullish-coalescing */\n  }\n\n})).actions(self => ({\n  set(key, value) {\n    self[key] = value;\n  }\n\n})); // eslint-disable-next-line @typescript-eslint/no-empty-interface, @typescript-eslint/consistent-type-definitions","map":{"version":3,"sources":["/home/runner/work/site/site/modules/message/state/models/EmbedModel.ts"],"names":["isValid","getParentOfType","types","ColorModel","nullableDate","getUniqueId","FieldModel","MessageModel","EmbedModel","model","id","optional","identifierNumber","title","description","url","color","fields","array","late","author","authorUrl","authorIcon","footer","footerIcon","timestamp","gallery","string","thumbnail","views","self","message","length","reduce","field","name","value","size","Math","max","hasTitle","trim","hasDescription","hasAuthor","hasFooter","data","map","undefined","inline","icon_url","text","embeds","raw","toJSON","image","slice","push","displayName","split","line","find","Boolean","actions","set","key"],"mappings":"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","sourcesContent":["/* eslint-disable import/no-cycle */\n\nimport { isValid } from \"date-fns\"\nimport {\n  getParentOfType,\n  Instance,\n  SnapshotOrInstance,\n  types,\n} from \"mobx-state-tree\"\nimport { ColorModel } from \"../../../../common/input/color/ColorModel\"\nimport { nullableDate } from \"../../../../common/state/nullableDate\"\nimport { getUniqueId } from \"../../../../common/state/uid\"\nimport type { AuthorData } from \"../data/AuthorData\"\nimport type { EmbedData } from \"../data/EmbedData\"\nimport type { FieldData } from \"../data/FieldData\"\nimport type { FooterData } from \"../data/FooterData\"\nimport { FieldModel } from \"./FieldModel\"\nimport { MessageLike, MessageModel } from \"./MessageModel\"\n\nexport const EmbedModel = types\n  .model(\"EmbedModel\", {\n    id: types.optional(types.identifierNumber, getUniqueId),\n    title: \"\",\n    description: \"\",\n    url: \"\",\n    color: types.optional(ColorModel, {}),\n    fields: types.array(types.late(() => FieldModel)),\n    author: \"\",\n    authorUrl: \"\",\n    authorIcon: \"\",\n    footer: \"\",\n    footerIcon: \"\",\n    timestamp: types.optional(nullableDate, null),\n    gallery: types.array(types.string),\n    thumbnail: \"\",\n  })\n  .views(self => ({\n    get message(): MessageLike {\n      return getParentOfType(self, MessageModel)\n    },\n\n    get length() {\n      return (\n        self.title.length +\n        self.description.length +\n        self.fields.reduce(\n          (length, field) => length + field.name.length + field.value.length,\n          0,\n        ) +\n        self.author.length +\n        self.footer.length\n      )\n    },\n\n    get size() {\n      return Math.max(self.gallery.length, 1)\n    },\n\n    get hasTitle() {\n      return self.title.trim().length > 0\n    },\n    get hasDescription() {\n      return self.description.trim().length > 0\n    },\n    get hasAuthor() {\n      return self.author.trim().length > 0\n    },\n    get hasFooter() {\n      return self.footer.trim().length > 0 || isValid(self.timestamp)\n    },\n\n    get data(): readonly EmbedData[] {\n      const fields: FieldData[] | undefined =\n        self.fields.length > 0\n          ? self.fields.map(field => ({\n              name: field.name || undefined,\n              value: field.value || undefined,\n              inline: field.inline || undefined,\n            }))\n          : undefined\n\n      const author: AuthorData | undefined = this.hasAuthor\n        ? {\n            name: self.author,\n            url: self.authorUrl || undefined,\n            icon_url: self.authorIcon || undefined,\n          }\n        : undefined\n\n      const footer: FooterData | undefined =\n        self.footer.trim().length > 0 ||\n        (isValid(self.timestamp) && self.footerIcon)\n          ? {\n              text: self.footer || undefined,\n              icon_url: self.footerIcon || undefined,\n            }\n          : undefined\n\n      const embeds: EmbedData[] = [\n        {\n          title: self.title || undefined,\n          description: self.description || undefined,\n          url: self.url || undefined,\n          color: self.color.raw,\n          fields,\n          author,\n          footer,\n          timestamp: isValid(self.timestamp)\n            ? self.timestamp.toJSON()\n            : undefined,\n          image: self.gallery.length > 0 ? { url: self.gallery[0] } : undefined,\n          thumbnail: self.thumbnail ? { url: self.thumbnail } : undefined,\n        },\n      ]\n\n      for (const image of self.gallery.slice(1)) {\n        embeds.push({\n          url: self.url,\n          image: { url: image },\n        })\n      }\n\n      return embeds\n    },\n\n    get displayName() {\n      /* eslint-disable @typescript-eslint/prefer-nullish-coalescing */\n      return (\n        self.author\n          .split(\"\\n\")\n          .map(line => line.trim())\n          .find(Boolean) ||\n        self.title\n          .split(\"\\n\")\n          .map(line => line.trim())\n          .find(Boolean) ||\n        self.description\n          .split(\"\\n\")\n          .map(line => line.trim())\n          .find(Boolean) ||\n        self.fields.map(field => field.displayName).find(Boolean) ||\n        self.footer\n          .split(\"\\n\")\n          .map(line => line.trim())\n          .find(Boolean) ||\n        undefined\n      )\n      /* eslint-enable @typescript-eslint/prefer-nullish-coalescing */\n    },\n  }))\n  .actions(self => ({\n    set<K extends keyof typeof self>(\n      key: K,\n      value: SnapshotOrInstance<typeof self[K]>,\n    ) {\n      self[key] = value\n    },\n  }))\n\n// eslint-disable-next-line @typescript-eslint/no-empty-interface, @typescript-eslint/consistent-type-definitions\nexport interface EmbedLike extends Instance<typeof EmbedModel> {}\n"]},"metadata":{},"sourceType":"module"}