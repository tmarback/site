{"ast":null,"code":"import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useObserver } from \"mobx-react-lite\";\nimport React, { useRef, useState } from \"react\";\nimport styled, { useTheme } from \"styled-components\";\nimport { PopoverContainer } from \"../../popover/PopoverContainer\";\nimport { usePopover } from \"../../popover/usePopover\";\nimport { useAutorun } from \"../../state/useAutorun\";\nimport { Input } from \"../layout/Input\";\nimport { InputField } from \"../text/InputField\";\nimport { ColorPicker } from \"./ColorPicker\";\nconst RGB_STRING_RE = /^([01]?\\d{1,2}|2[0-4]\\d|25[0-5])[\\s,]\\s*([01]?\\d{1,2}|2[0-4]\\d|25[0-5])[\\s,]\\s*([01]?\\d{1,2}|2[0-4]\\d|25[0-5])$/;\nconst MonoInputField = styled(InputField).withConfig({\n  componentId: \"sc-15if2js-0\"\n})([\"& \", \"{font-size:15px;font-family:\", \";}\"], Input, ({\n  theme\n}) => theme.font.mono);\nconst Preview = styled.div.withConfig({\n  componentId: \"sc-15if2js-1\"\n})([\"min-width:36px;max-width:36px;min-height:36px;max-height:36px;border-radius:4px;box-shadow:inset \", \";margin-left:8px;\"], ({\n  theme\n}) => theme.elavation.stroke);\nexport function ColorInputField(props) {\n  const {\n    id,\n    color,\n    label\n  } = props;\n  const {\n    0: value,\n    1: setValue\n  } = useState(() => {\n    var _color$hex;\n\n    return (_color$hex = color.hex) !== null && _color$hex !== void 0 ? _color$hex : \"\";\n  });\n  const {\n    0: touched,\n    1: setTouched\n  } = useState(false);\n  useAutorun(() => {\n    var _color$hex2;\n\n    if (!touched) setValue((_color$hex2 = color.hex) !== null && _color$hex2 !== void 0 ? _color$hex2 : \"\");\n  });\n  const inputRef = useRef(null);\n  const popover = usePopover({\n    ref: inputRef,\n    render: () => /*#__PURE__*/_jsx(PopoverContainer, {\n      children: /*#__PURE__*/_jsx(ColorPicker, {\n        color: color\n      })\n    }),\n    placement: \"bottom-start\",\n    shards: [inputRef]\n  });\n  const theme = useTheme();\n  return useObserver(() => {\n    var _color$hex4;\n\n    return /*#__PURE__*/_jsx(MonoInputField, {\n      ref: inputRef,\n      id: id,\n      value: value,\n      onChange: value => {\n        setTouched(true);\n        setValue(value.toLowerCase());\n\n        if (/^#?[\\da-f]{6}$/i.test(value)) {\n          color.setHex(value);\n        } else if (!value) {\n          color.invalidate();\n        } else {\n          const match = RGB_STRING_RE.exec(value);\n\n          if (match) {\n            const [, red, green, blue] = [...match].map(Number);\n            color.setRaw(red * 0x010000 + green * 0x000100 + blue);\n          }\n        }\n      },\n      onBlur: () => {\n        var _color$hex3;\n\n        setTouched(false);\n        setValue((_color$hex3 = color.hex) !== null && _color$hex3 !== void 0 ? _color$hex3 : \"\");\n      },\n      label: label,\n      placeholder: \"#rrggbb\",\n      onClick: () => {\n        popover.spawn();\n      },\n      children: /*#__PURE__*/_jsx(Preview, {\n        role: \"presentation\",\n        style: {\n          backgroundColor: (_color$hex4 = color.hex) !== null && _color$hex4 !== void 0 ? _color$hex4 : theme.background.tertiary\n        },\n        onClick: () => {\n          popover.spawn();\n        }\n      })\n    });\n  });\n}","map":{"version":3,"sources":["/home/runner/work/site/site/common/input/color/ColorInputField.tsx"],"names":["useObserver","React","useRef","useState","styled","useTheme","PopoverContainer","usePopover","useAutorun","Input","InputField","ColorPicker","RGB_STRING_RE","MonoInputField","theme","font","mono","Preview","div","elavation","stroke","ColorInputField","props","id","color","label","value","setValue","hex","touched","setTouched","inputRef","popover","ref","render","placement","shards","toLowerCase","test","setHex","invalidate","match","exec","red","green","blue","map","Number","setRaw","spawn","backgroundColor","background","tertiary"],"mappings":"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","sourcesContent":["import { useObserver } from \"mobx-react-lite\"\nimport React, { useRef, useState } from \"react\"\nimport styled, { useTheme } from \"styled-components\"\nimport { PopoverContainer } from \"../../popover/PopoverContainer\"\nimport { usePopover } from \"../../popover/usePopover\"\nimport { useAutorun } from \"../../state/useAutorun\"\nimport { Input } from \"../layout/Input\"\nimport { InputField } from \"../text/InputField\"\nimport type { ColorLike } from \"./ColorModel\"\nimport { ColorPicker } from \"./ColorPicker\"\n\nconst RGB_STRING_RE = /^([01]?\\d{1,2}|2[0-4]\\d|25[0-5])[\\s,]\\s*([01]?\\d{1,2}|2[0-4]\\d|25[0-5])[\\s,]\\s*([01]?\\d{1,2}|2[0-4]\\d|25[0-5])$/\n\nconst MonoInputField = styled(InputField)`\n  & ${Input} {\n    font-size: 15px;\n    font-family: ${({ theme }) => theme.font.mono};\n  }\n`\n\nconst Preview = styled.div`\n  min-width: 36px;\n  max-width: 36px;\n  min-height: 36px;\n  max-height: 36px;\n\n  border-radius: 4px;\n\n  box-shadow: inset ${({ theme }) => theme.elavation.stroke};\n\n  margin-left: 8px;\n`\n\nexport type ColorInputProps = {\n  id: string\n  color: ColorLike\n  label: string\n}\n\nexport function ColorInputField(props: ColorInputProps) {\n  const { id, color, label } = props\n\n  const [value, setValue] = useState(() => color.hex ?? \"\")\n  const [touched, setTouched] = useState(false)\n\n  useAutorun(() => {\n    if (!touched) setValue(color.hex ?? \"\")\n  })\n\n  const inputRef = useRef<HTMLInputElement>(null)\n\n  const popover = usePopover({\n    ref: inputRef,\n    render: () => (\n      <PopoverContainer>\n        <ColorPicker color={color} />\n      </PopoverContainer>\n    ),\n    placement: \"bottom-start\",\n    shards: [inputRef],\n  })\n\n  const theme = useTheme()\n\n  return useObserver(() => (\n    <MonoInputField\n      ref={inputRef}\n      id={id}\n      value={value}\n      onChange={value => {\n        setTouched(true)\n        setValue(value.toLowerCase())\n\n        if (/^#?[\\da-f]{6}$/i.test(value)) {\n          color.setHex(value)\n        } else if (!value) {\n          color.invalidate()\n        } else {\n          const match = RGB_STRING_RE.exec(value)\n          if (match) {\n            const [, red, green, blue] = [...match].map(Number)\n            color.setRaw(red * 0x010000 + green * 0x000100 + blue)\n          }\n        }\n      }}\n      onBlur={() => {\n        setTouched(false)\n        setValue(color.hex ?? \"\")\n      }}\n      label={label}\n      placeholder=\"#rrggbb\"\n      onClick={() => {\n        popover.spawn()\n      }}\n    >\n      <Preview\n        role=\"presentation\"\n        style={{ backgroundColor: color.hex ?? theme.background.tertiary }}\n        onClick={() => {\n          popover.spawn()\n        }}\n      />\n    </MonoInputField>\n  ))\n}\n"]},"metadata":{},"sourceType":"module"}