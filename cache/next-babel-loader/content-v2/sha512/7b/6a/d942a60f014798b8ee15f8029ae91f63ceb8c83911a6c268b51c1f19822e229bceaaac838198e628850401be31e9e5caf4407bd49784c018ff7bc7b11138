{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useObserver } from \"mobx-react-lite\";\nimport { destroy } from \"mobx-state-tree\";\nimport { useRouter } from \"next/router\";\nimport React, { useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport { ModalManagerContext } from \"../common/modal/ModalManagerContext\";\nimport { Footer } from \"../common/page/Footer\";\nimport { Header } from \"../common/page/Header\";\nimport { PageHead } from \"../common/page/PageHead\";\nimport { PreferencesModal } from \"../common/settings/PreferencesModal\";\nimport { useLazyValue } from \"../common/state/useLazyValue\";\nimport { useRequiredContext } from \"../common/state/useRequiredContext\";\nimport { EditorManager } from \"../modules/editor/EditorManager\";\nimport { EditorManagerProvider } from \"../modules/editor/EditorManagerContext\";\nimport { Preview } from \"../modules/message/preview/Preview\";\nconst Container = styled.div.withConfig({\n  componentId: \"gxogrm-0\"\n})([\"height:100%;overflow-y:auto;display:flex;flex-flow:column;\"]);\nconst Content = styled.div.withConfig({\n  componentId: \"gxogrm-1\"\n})([\"flex:1;\"]);\nexport var __N_SSP = true;\nexport default function Viewer(props) {\n  const {\n    state\n  } = props;\n  const editorManager = useLazyValue(() => EditorManager.create(state));\n  useEffect(() => () => destroy(editorManager), [editorManager]);\n  const modalManager = useRequiredContext(ModalManagerContext);\n\n  const spawnSettingsModal = () => modalManager.spawn({\n    render: () => /*#__PURE__*/_jsx(PreferencesModal, {})\n  });\n\n  const router = useRouter();\n  return useObserver(() => /*#__PURE__*/_jsxs(EditorManagerProvider, {\n    value: editorManager,\n    children: [/*#__PURE__*/_jsx(PageHead, {\n      title: \"Message Viewer\",\n      description: \"Discohook's standalone message viewer.\",\n      children: /*#__PURE__*/_jsx(\"meta\", {\n        name: \"referrer\",\n        content: \"strict-origin\"\n      }, \"referrer\")\n    }), /*#__PURE__*/_jsxs(Container, {\n      children: [/*#__PURE__*/_jsx(Header, {\n        items: [{\n          name: \"Editor\",\n          to: `/?data=${encodeURIComponent(String(router.query.data))}`\n        }, {\n          name: \"Settings\",\n          handler: spawnSettingsModal\n        }]\n      }), /*#__PURE__*/_jsx(Content, {\n        children: /*#__PURE__*/_jsx(Preview, {})\n      }), /*#__PURE__*/_jsx(Footer, {})]\n    })]\n  }));\n}","map":{"version":3,"sources":["/home/runner/work/site/site/pages/viewer.tsx"],"names":["useObserver","destroy","useRouter","React","useEffect","styled","ModalManagerContext","Footer","Header","PageHead","PreferencesModal","useLazyValue","useRequiredContext","EditorManager","EditorManagerProvider","Preview","Container","div","Content","Viewer","props","state","editorManager","create","modalManager","spawnSettingsModal","spawn","render","router","name","to","encodeURIComponent","String","query","data","handler"],"mappings":";;AAAA,SAASA,WAAT,QAA4B,iBAA5B;AACA,SAASC,OAAT,QAAkD,iBAAlD;AAEA,SAASC,SAAT,QAA0B,aAA1B;AACA,OAAOC,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,MAAP,MAAmB,mBAAnB;AACA,SAASC,mBAAT,QAAoC,qCAApC;AACA,SAASC,MAAT,QAAuB,uBAAvB;AACA,SAASC,MAAT,QAAuB,uBAAvB;AACA,SAASC,QAAT,QAAyB,yBAAzB;AACA,SAASC,gBAAT,QAAiC,qCAAjC;AACA,SAASC,YAAT,QAA6B,8BAA7B;AACA,SAASC,kBAAT,QAAmC,oCAAnC;AACA,SAASC,aAAT,QAA8B,iCAA9B;AACA,SAASC,qBAAT,QAAsC,wCAAtC;AAEA,SAASC,OAAT,QAAwB,oCAAxB;AAEA,MAAMC,SAAS,GAAGX,MAAM,CAACY,GAAV;AAAA;AAAA,kEAAf;AAOA,MAAMC,OAAO,GAAGb,MAAM,CAACY,GAAV;AAAA;AAAA,eAAb;;AAQA,eAAe,SAASE,MAAT,CAAgBC,KAAhB,EAAoC;AACjD,QAAM;AAAEC,IAAAA;AAAF,MAAYD,KAAlB;AAEA,QAAME,aAAa,GAAGX,YAAY,CAAC,MAAME,aAAa,CAACU,MAAd,CAAqBF,KAArB,CAAP,CAAlC;AACAjB,EAAAA,SAAS,CAAC,MAAM,MAAMH,OAAO,CAACqB,aAAD,CAApB,EAAqC,CAACA,aAAD,CAArC,CAAT;AAEA,QAAME,YAAY,GAAGZ,kBAAkB,CAACN,mBAAD,CAAvC;;AACA,QAAMmB,kBAAkB,GAAG,MACzBD,YAAY,CAACE,KAAb,CAAmB;AAAEC,IAAAA,MAAM,EAAE,mBAAM,KAAC,gBAAD;AAAhB,GAAnB,CADF;;AAGA,QAAMC,MAAM,GAAG1B,SAAS,EAAxB;AAEA,SAAOF,WAAW,CAAC,mBACjB,MAAC,qBAAD;AAAuB,IAAA,KAAK,EAAEsB,aAA9B;AAAA,4BACE,KAAC,QAAD;AACE,MAAA,KAAK,EAAC,gBADR;AAEE,MAAA,WAAW,EAAC,wCAFd;AAAA,6BAIE;AAAqB,QAAA,IAAI,EAAC,UAA1B;AAAqC,QAAA,OAAO,EAAC;AAA7C,SAAU,UAAV;AAJF,MADF,eAOE,MAAC,SAAD;AAAA,8BACE,KAAC,MAAD;AACE,QAAA,KAAK,EAAE,CACL;AACEO,UAAAA,IAAI,EAAE,QADR;AAEEC,UAAAA,EAAE,EAAG,UAASC,kBAAkB,CAACC,MAAM,CAACJ,MAAM,CAACK,KAAP,CAAaC,IAAd,CAAP,CAA4B;AAF9D,SADK,EAKL;AAAEL,UAAAA,IAAI,EAAE,UAAR;AAAoBM,UAAAA,OAAO,EAAEV;AAA7B,SALK;AADT,QADF,eAUE,KAAC,OAAD;AAAA,+BACE,KAAC,OAAD;AADF,QAVF,eAaE,KAAC,MAAD,KAbF;AAAA,MAPF;AAAA,IADgB,CAAlB;AAyBD","sourcesContent":["import { useObserver } from \"mobx-react-lite\"\nimport { destroy, getSnapshot, SnapshotOut } from \"mobx-state-tree\"\nimport type { GetServerSidePropsContext } from \"next\"\nimport { useRouter } from \"next/router\"\nimport React, { useEffect } from \"react\"\nimport styled from \"styled-components\"\nimport { ModalManagerContext } from \"../common/modal/ModalManagerContext\"\nimport { Footer } from \"../common/page/Footer\"\nimport { Header } from \"../common/page/Header\"\nimport { PageHead } from \"../common/page/PageHead\"\nimport { PreferencesModal } from \"../common/settings/PreferencesModal\"\nimport { useLazyValue } from \"../common/state/useLazyValue\"\nimport { useRequiredContext } from \"../common/state/useRequiredContext\"\nimport { EditorManager } from \"../modules/editor/EditorManager\"\nimport { EditorManagerProvider } from \"../modules/editor/EditorManagerContext\"\nimport { getEditorManagerFromQuery } from \"../modules/editor/getEditorManagerFromQuery\"\nimport { Preview } from \"../modules/message/preview/Preview\"\n\nconst Container = styled.div`\n  height: 100%;\n  overflow-y: auto;\n  display: flex;\n  flex-flow: column;\n`\n\nconst Content = styled.div`\n  flex: 1;\n`\n\nexport type ViewerProps = {\n  state: SnapshotOut<typeof EditorManager>\n}\n\nexport default function Viewer(props: ViewerProps) {\n  const { state } = props\n\n  const editorManager = useLazyValue(() => EditorManager.create(state))\n  useEffect(() => () => destroy(editorManager), [editorManager])\n\n  const modalManager = useRequiredContext(ModalManagerContext)\n  const spawnSettingsModal = () =>\n    modalManager.spawn({ render: () => <PreferencesModal /> })\n\n  const router = useRouter()\n\n  return useObserver(() => (\n    <EditorManagerProvider value={editorManager}>\n      <PageHead\n        title=\"Message Viewer\"\n        description=\"Discohook's standalone message viewer.\"\n      >\n        <meta key=\"referrer\" name=\"referrer\" content=\"strict-origin\" />\n      </PageHead>\n      <Container>\n        <Header\n          items={[\n            {\n              name: \"Editor\",\n              to: `/?data=${encodeURIComponent(String(router.query.data))}`,\n            },\n            { name: \"Settings\", handler: spawnSettingsModal },\n          ]}\n        />\n        <Content>\n          <Preview />\n        </Content>\n        <Footer />\n      </Container>\n    </EditorManagerProvider>\n  ))\n}\n\nexport const getServerSideProps = (\n  context: GetServerSidePropsContext,\n): { props: ViewerProps } => {\n  return {\n    props: {\n      state: getSnapshot(getEditorManagerFromQuery(context.query)),\n    },\n  }\n}\n"]},"metadata":{},"sourceType":"module"}