{"ast":null,"code":"function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { base64Decode } from \"../../common/base64/base64Decode\";\nimport { parseJson } from \"../../common/object/parseJson\";\nimport { toSnakeCase } from \"../../common/object/toSnakeCase\";\nimport { messageOf } from \"../message/helpers/messageOf\";\nimport { MESSAGE_REF_RE } from \"../webhook/constants\";\nimport { DEFAULT_EDITOR_MANAGER_STATE } from \"./defaultEditorManagerState\";\nimport { EditorManager } from \"./EditorManager\";\nexport const getEditorManagerFromQuery = query => {\n  var _base64Decode, _ref, _query$data;\n\n  const {\n    value,\n    error\n  } = parseJson((_base64Decode = base64Decode(String((_ref = (_query$data = query.data) !== null && _query$data !== void 0 ? _query$data : query.message) !== null && _ref !== void 0 ? _ref : \"\"))) !== null && _base64Decode !== void 0 ? _base64Decode : \"\");\n\n  if (error || !value || typeof value !== \"object\") {\n    return EditorManager.create(DEFAULT_EDITOR_MANAGER_STATE);\n  }\n\n  if (\"message\" in value) {\n    return EditorManager.create({\n      messages: [messageOf(toSnakeCase(value.message))]\n    });\n  }\n\n  if (!(\"messages\" in value) || !Array.isArray(value.messages)) {\n    return EditorManager.create(DEFAULT_EDITOR_MANAGER_STATE);\n  }\n\n  return EditorManager.create({\n    messages: value.messages.map(message => {\n      var _MESSAGE_REF_RE$exec;\n\n      if (typeof message !== \"object\" || !message || !(\"data\" in message)) {\n        return {};\n      }\n\n      return _objectSpread(_objectSpread({}, messageOf(message.data)), {}, {\n        reference: message.reference && ((_MESSAGE_REF_RE$exec = MESSAGE_REF_RE.exec(String(message.reference))) === null || _MESSAGE_REF_RE$exec === void 0 ? void 0 : _MESSAGE_REF_RE$exec[0]) || undefined,\n        timestamp: \"timestamp\" in message ? new Date(String(message.timestamp)) : undefined,\n        badge: \"badge\" in message ? message.badge === null ? null : String(message.badge) : undefined\n      });\n    }),\n    targets: \"targets\" in value && Array.isArray(value.targets) ? value.targets.map(target => {\n      if (typeof target !== \"object\" || !target || !(\"url\" in target)) {\n        return {};\n      }\n\n      return {\n        url: String(target.url)\n      };\n    }) : [{}]\n  });\n};","map":null,"metadata":{},"sourceType":"module"}